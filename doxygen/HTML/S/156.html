<html>
<head>
<title>ovr/sdk/src/Kernel/OVR_SysFile.cpp</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.7.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/215.html'>ovr</a>/<a href='../files/216.html'>sdk</a>/<a href='../files/218.html'>src</a>/<a href='../files/221.html'>Kernel</a>/OVR_SysFile.cpp</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L46'>[^]</a><a href='#L127'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L46' title='Defined at 46.'>GetFilePath</a>
<li><a href='#L49' title='Defined at 49.'>IsValid</a>
<li><a href='#L50' title='Defined at 50.'>IsWritable</a>
<li><a href='#L53' title='Defined at 53.'>Tell</a>
<li><a href='#L54' title='Defined at 54.'>LTell</a>
<li><a href='#L55' title='Defined at 55.'>GetLength</a>
<li><a href='#L56' title='Defined at 56.'>LGetLength</a>
<li><a href='#L59' title='Defined at 59.'>GetErrorCode</a>
<li><a href='#L62' title='Defined at 62.'>Write</a>
<li><a href='#L63' title='Defined at 63.'>Read</a>
<li><a href='#L64' title='Defined at 64.'>SkipBytes</a>
<li><a href='#L65' title='Defined at 65.'>BytesAvailable</a>
<li><a href='#L66' title='Defined at 66.'>Flush</a>
<li><a href='#L67' title='Defined at 67.'>Seek</a>
<li><a href='#L68' title='Defined at 68.'>LSeek</a>
<li><a href='#L70' title='Defined at 70.'>CopyFromStream</a>
<li><a href='#L71' title='Defined at 71.'>Close</a>
<li><a href='#L98' title='Defined at 98.'>Open</a>
<li><a href='#L116' title='Defined at 116.'>GetErrorCode</a>
<li><a href='#L123' title='Defined at 123.'>IsValid</a>
<li><a href='#L127' title='Defined at 127.'>Close</a>
</ol>
<hr>
<pre>
<a name='L1'>   1 <i><font color='green'>/**************************************************************************</font></i>
<a name='L2'>   2 <i><font color='green'></font></i>
<a name='L3'>   3 <i><font color='green'>Filename    :   OVR_SysFile.cpp</font></i>
<a name='L4'>   4 <i><font color='green'>Content     :   File wrapper class implementation (Win32)</font></i>
<a name='L5'>   5 <i><font color='green'></font></i>
<a name='L6'>   6 <i><font color='green'>Created     :   April 5, 1999</font></i>
<a name='L7'>   7 <i><font color='green'>Authors     :   Michael Antonov</font></i>
<a name='L8'>   8 <i><font color='green'></font></i>
<a name='L9'>   9 <i><font color='green'>Copyright   :   Copyright 2014 Oculus VR, Inc. All Rights reserved.</font></i>
<a name='L10'>  10 <i><font color='green'></font></i>
<a name='L11'>  11 <i><font color='green'>Licensed under the Oculus VR Rift SDK License Version 3.1 (the "License"); </font></i>
<a name='L12'>  12 <i><font color='green'>you may not use the Oculus VR Rift SDK except in compliance with the License, </font></i>
<a name='L13'>  13 <i><font color='green'>which is provided at the time of installation or download, or which </font></i>
<a name='L14'>  14 <i><font color='green'>otherwise accompanies this software in either electronic or hard copy form.</font></i>
<a name='L15'>  15 <i><font color='green'></font></i>
<a name='L16'>  16 <i><font color='green'>You may obtain a copy of the License at</font></i>
<a name='L17'>  17 <i><font color='green'></font></i>
<a name='L18'>  18 <i><font color='green'>http://www.oculusvr.com/licenses/LICENSE-3.1 </font></i>
<a name='L19'>  19 <i><font color='green'></font></i>
<a name='L20'>  20 <i><font color='green'>Unless required by applicable law or agreed to in writing, the Oculus VR SDK </font></i>
<a name='L21'>  21 <i><font color='green'>distributed under the License is distributed on an "AS IS" BASIS,</font></i>
<a name='L22'>  22 <i><font color='green'>WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</font></i>
<a name='L23'>  23 <i><font color='green'>See the License for the specific language governing permissions and</font></i>
<a name='L24'>  24 <i><font color='green'>limitations under the License.</font></i>
<a name='L25'>  25 <i><font color='green'></font></i>
<a name='L26'>  26 <i><font color='green'>**************************************************************************/</font></i>
<a name='L27'>  27 
<a name='L28'>  28 <font color='darkred'>#define</font>  GFILE_CXX
<a name='L29'>  29 
<a name='L30'>  30 <i><font color='green'>// Standard C library (Captain Obvious guarantees!)</font></i>
<a name='L31'>  31 <font color='darkred'>#include</font> &lt;stdio.h&gt;
<a name='L32'>  32 
<a name='L33'>  33 <font color='darkred'>#include</font> "<a href='146.html'>OVR_SysFile.h</a>"
<a name='L34'>  34 <font color='darkred'>#include</font> "<a href='155.html'>OVR_Log.h</a>"
<a name='L35'>  35 
<a name='L36'>  36 <b>namespace</b> <a href='../R/624.html' title='Multiple refered from 184 places.'>OVR</a> <font color='red'>{</font>
<a name='L37'>  37 
<a name='L38'>  38 <i><font color='green'>// This is - a dummy file that fails on all calls.</font></i>
<a name='L39'>  39 
<a name='L40'>  40 <b>class</b> <a href='../R/1153.html' title='Multiple refered from 3 places.'>UnopenedFile</a> : <b>public</b> File
<a name='L41'>  41 <font color='red'>{</font>
<a name='L42'>  42 <b>public</b>:
<a name='L43'>  43     UnopenedFile()  <font color='red'>{</font> <font color='red'>}</font>
<a name='L44'>  44     ~UnopenedFile() <font color='red'>{</font> <font color='red'>}</font>
<a name='L45'>  45 
<a name='L46'>  46     <b>virtual</b> <b>const</b> <b>char</b>* <a href='../R/326.html' title='Multiple refered from 4 places.'>GetFilePath</a>()               <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>
<a name='L47'>  47 
<a name='L48'>  48     <i><font color='green'>// ** File Information</font></i>
<a name='L49'>  49     <b>virtual</b> <b>bool</b>        <a href='../R/483.html' title='Multiple refered from 13 places.'>IsValid</a>()                   <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>
<a name='L50'>  50     <b>virtual</b> <b>bool</b>        <a href='../R/484.html' title='Multiple refered from 5 places.'>IsWritable</a>()                <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>
<a name='L51'>  51 
<a name='L52'>  52     <i><font color='green'>// Return position / file size</font></i>
<a name='L53'>  53     <b>virtual</b> <b>int</b>         <a href='../R/1081.html' title='Multiple refered from 13 places.'>Tell</a>()                      <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>
<a name='L54'>  54     <b>virtual</b> <a href='../D/983.html' title='Multiple defined in 3 places.'>SInt64</a>      <a href='../R/503.html' title='Multiple refered from 12 places.'>LTell</a>()                     <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>
<a name='L55'>  55     <b>virtual</b> <b>int</b>         <a href='../R/349.html' title='Multiple refered from 20 places.'>GetLength</a>()                 <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>
<a name='L56'>  56     <b>virtual</b> <a href='../D/983.html' title='Multiple defined in 3 places.'>SInt64</a>      <a href='../R/497.html' title='Multiple refered from 7 places.'>LGetLength</a>()                <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>
<a name='L57'>  57 
<a name='L58'>  58 <i><font color='green'>//  virtual bool        Stat(FileStats *pfs)        { return 0; }</font></i>
<a name='L59'>  59     <b>virtual</b> <b>int</b>         <a href='../R/317.html' title='Multiple refered from 6 places.'>GetErrorCode</a>()              <font color='red'>{</font> <b>return</b> <a href='../Y/519.html' title='Multiple used in 4 places.'>Error_FileNotFound</a>; <font color='red'>}</font>
<a name='L60'>  60 
<a name='L61'>  61     <i><font color='green'>// ** Stream implementation &amp; I/O</font></i>
<a name='L62'>  62     <b>virtual</b> <b>int</b>         <a href='../R/1187.html' title='Multiple refered from 21 places.'>Write</a>(<b>const</b> <a href='../Y/2313.html' title='Multiple used in 28 places.'>UByte</a> *<a href='../Y/4010.html' title='Multiple used in 52 places.'>pbuffer</a>, <b>int</b> <a href='../Y/3776.html' title='Multiple used in 71 places.'>numBytes</a>)     <font color='red'>{</font> <b>return</b> -1; <a href='../S/168.html#L429' title='Defined at 429 in ovr/sdk/src/Kernel/OVR_Types.h.'>OVR_UNUSED2</a>(<a href='../Y/4010.html' title='Multiple used in 52 places.'>pbuffer</a>, <a href='../Y/3776.html' title='Multiple used in 71 places.'>numBytes</a>); <font color='red'>}</font>
<a name='L63'>  63     <b>virtual</b> <b>int</b>         <a href='../R/876.html' title='Multiple refered from 20 places.'>Read</a>(<a href='../Y/2313.html' title='Multiple used in 28 places.'>UByte</a> *<a href='../Y/4010.html' title='Multiple used in 52 places.'>pbuffer</a>, <b>int</b> <a href='../Y/3776.html' title='Multiple used in 71 places.'>numBytes</a>)            <font color='red'>{</font> <b>return</b> -1; <a href='../S/168.html#L429' title='Defined at 429 in ovr/sdk/src/Kernel/OVR_Types.h.'>OVR_UNUSED2</a>(<a href='../Y/4010.html' title='Multiple used in 52 places.'>pbuffer</a>, <a href='../Y/3776.html' title='Multiple used in 71 places.'>numBytes</a>); <font color='red'>}</font>
<a name='L64'>  64     <b>virtual</b> <b>int</b>         <a href='../R/1047.html' title='Multiple refered from 6 places.'>SkipBytes</a>(<b>int</b> <a href='../Y/3776.html' title='Multiple used in 71 places.'>numBytes</a>)                       <font color='red'>{</font> <b>return</b> 0;  <a href='../D/810.html' title='Multiple defined in 2 places.'>OVR_UNUSED</a>(<a href='../Y/3776.html' title='Multiple used in 71 places.'>numBytes</a>); <font color='red'>}</font>
<a name='L65'>  65     <b>virtual</b> <b>int</b>         <a href='../R/76.html' title='Multiple refered from 7 places.'>BytesAvailable</a>()                              <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>
<a name='L66'>  66     <b>virtual</b> <b>bool</b>        <a href='../R/261.html' title='Multiple refered from 8 places.'>Flush</a>()                                       <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>
<a name='L67'>  67     <b>virtual</b> <b>int</b>         <a href='../R/944.html' title='Multiple refered from 14 places.'>Seek</a>(<b>int</b> <a href='../Y/3801.html' title='Multiple used in 71 places.'>offset</a>, <b>int</b> <a href='../Y/3821.html' title='Multiple used in 29 places.'>origin</a>)                  <font color='red'>{</font> <b>return</b> -1; <a href='../S/168.html#L429' title='Defined at 429 in ovr/sdk/src/Kernel/OVR_Types.h.'>OVR_UNUSED2</a>(<a href='../Y/3801.html' title='Multiple used in 71 places.'>offset</a>, <a href='../Y/3821.html' title='Multiple used in 29 places.'>origin</a>); <font color='red'>}</font>
<a name='L68'>  68     <b>virtual</b> <a href='../D/983.html' title='Multiple defined in 3 places.'>SInt64</a>      <a href='../R/498.html' title='Multiple refered from 10 places.'>LSeek</a>(<a href='../Y/1912.html' title='Multiple used in 4 places.'>SInt64</a> <a href='../Y/3801.html' title='Multiple used in 71 places.'>offset</a>, <b>int</b> <a href='../Y/3821.html' title='Multiple used in 29 places.'>origin</a>)              <font color='red'>{</font> <b>return</b> -1; <a href='../S/168.html#L429' title='Defined at 429 in ovr/sdk/src/Kernel/OVR_Types.h.'>OVR_UNUSED2</a>(<a href='../Y/3801.html' title='Multiple used in 71 places.'>offset</a>, <a href='../Y/3821.html' title='Multiple used in 29 places.'>origin</a>); <font color='red'>}</font>
<a name='L69'>  69     
<a name='L70'>  70     <b>virtual</b> <b>int</b>         <a href='../R/128.html' title='Multiple refered from 5 places.'>CopyFromStream</a>(<a href='../Y/586.html' title='Multiple used in 23 places.'>File</a> *<a href='../Y/4162.html' title='Multiple used in 10 places.'>pstream</a>, <b>int</b> <a href='../Y/2796.html' title='Multiple used in 17 places.'>byteSize</a>)   <font color='red'>{</font> <b>return</b> -1; <a href='../S/168.html#L429' title='Defined at 429 in ovr/sdk/src/Kernel/OVR_Types.h.'>OVR_UNUSED2</a>(<a href='../Y/4162.html' title='Multiple used in 10 places.'>pstream</a>, <a href='../Y/2796.html' title='Multiple used in 17 places.'>byteSize</a>); <font color='red'>}</font>
<a name='L71'>  71     <b>virtual</b> <b>bool</b>        <a href='../R/110.html' title='Multiple refered from 12 places.'>Close</a>()                                       <font color='red'>{</font> <b>return</b> 0; <font color='red'>}</font>    
<a name='L72'>  72 <font color='red'>}</font>;
<a name='L73'>  73 
<a name='L74'>  74 
<a name='L75'>  75 
<a name='L76'>  76 <i><font color='green'>// ***** System File</font></i>
<a name='L77'>  77 
<a name='L78'>  78 <i><font color='green'>// System file is created to access objects on file system directly</font></i>
<a name='L79'>  79 <i><font color='green'>// This file can refer directly to path</font></i>
<a name='L80'>  80 
<a name='L81'>  81 <i><font color='green'>// ** Constructor</font></i>
<a name='L82'>  82 <a href='../R/1069.html' title='Multiple refered from 14 places.'>SysFile</a>::<a href='../D/1142.html' title='Multiple defined in 2 places.'>SysFile</a>() : <a href='../Y/364.html' title='Multiple used in 14 places.'>DelegatedFile</a>(0)
<a name='L83'>  83 <font color='red'>{</font>
<a name='L84'>  84     <a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a> = *<b>new</b> <a href='../S/156.html#L40' title='Defined at 40 in ovr/sdk/src/Kernel/OVR_SysFile.cpp.'>UnopenedFile</a>;
<a name='L85'>  85 <font color='red'>}</font>
<a name='L86'>  86 
<a name='L87'>  87 <a href='../Y/1725.html' title='Multiple used in 115 places.'>Ptr</a>&lt;<a href='../Y/586.html' title='Multiple used in 23 places.'>File</a>&gt; <a href='../S/149.html#L564' title='Defined at 564 in ovr/sdk/src/Kernel/OVR_FileFILE.cpp.'>FileFILEOpen</a>(<b>const</b> <a href='../Y/2150.html' title='Multiple used in 24 places.'>String</a>&amp; <a href='../Y/4004.html' title='Multiple used in 77 places.'>path</a>, <b>int</b> <a href='../Y/3225.html' title='Multiple used in 25 places.'>flags</a>, <b>int</b> <a href='../Y/3697.html' title='Multiple used in 33 places.'>mode</a>);
<a name='L88'>  88 
<a name='L89'>  89 <i><font color='green'>// Opens a file</font></i>
<a name='L90'>  90 <a href='../R/1069.html' title='Multiple refered from 14 places.'>SysFile</a>::<a href='../D/1142.html' title='Multiple defined in 2 places.'>SysFile</a>(<b>const</b> <a href='../Y/2150.html' title='Multiple used in 24 places.'>String</a>&amp; <a href='../Y/4004.html' title='Multiple used in 77 places.'>path</a>, <b>int</b> <a href='../Y/3225.html' title='Multiple used in 25 places.'>flags</a>, <b>int</b> <a href='../Y/3697.html' title='Multiple used in 33 places.'>mode</a>) : <a href='../Y/364.html' title='Multiple used in 14 places.'>DelegatedFile</a>(0)
<a name='L91'>  91 <font color='red'>{</font>
<a name='L92'>  92     <a href='../D/856.html' title='Multiple defined in 2 places.'>Open</a>(<a href='../Y/4004.html' title='Multiple used in 77 places.'>path</a>, <a href='../Y/3225.html' title='Multiple used in 25 places.'>flags</a>, <a href='../Y/3697.html' title='Multiple used in 33 places.'>mode</a>);
<a name='L93'>  93 <font color='red'>}</font>
<a name='L94'>  94 
<a name='L95'>  95 
<a name='L96'>  96 <i><font color='green'>// ** Open &amp; management</font></i>
<a name='L97'>  97 <i><font color='green'>// Will fail if file's already open</font></i>
<a name='L98'>  98 <b>bool</b> <a href='../D/1142.html' title='Multiple defined in 2 places.'>SysFile</a>::<a href='../R/800.html' title='Multiple refered from 8 places.'>Open</a>(<b>const</b> <a href='../Y/2150.html' title='Multiple used in 24 places.'>String</a>&amp; <a href='../Y/4004.html' title='Multiple used in 77 places.'>path</a>, <b>int</b> <a href='../Y/3225.html' title='Multiple used in 25 places.'>flags</a>, <b>int</b> <a href='../Y/3697.html' title='Multiple used in 33 places.'>mode</a>)
<a name='L99'>  99 <font color='red'>{</font>
<a name='L100'> 100     <a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a> = <a href='../S/149.html#L564' title='Defined at 564 in ovr/sdk/src/Kernel/OVR_FileFILE.cpp.'>FileFILEOpen</a>(<a href='../Y/4004.html' title='Multiple used in 77 places.'>path</a>, <a href='../Y/3225.html' title='Multiple used in 25 places.'>flags</a>, <a href='../Y/3697.html' title='Multiple used in 33 places.'>mode</a>);
<a name='L101'> 101     <b>if</b> ((!<a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a>) || (!<a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a>-&gt;<a href='../D/500.html' title='Multiple defined in 3 places.'>IsValid</a>()))
<a name='L102'> 102     <font color='red'>{</font>
<a name='L103'> 103         <a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a> = *<b>new</b> <a href='../S/156.html#L40' title='Defined at 40 in ovr/sdk/src/Kernel/OVR_SysFile.cpp.'>UnopenedFile</a>;
<a name='L104'> 104         <a href='../D/704.html' title='Multiple defined in 2 places.'>OVR_DEBUG_LOG</a>(("Failed to open file: %s", <a href='../Y/4004.html' title='Multiple used in 77 places.'>path</a>.<a href='../Y/2271.html' title='Multiple used in 86 places.'>ToCStr</a>()));
<a name='L105'> 105         <b>return</b> 0;
<a name='L106'> 106     <font color='red'>}</font>
<a name='L107'> 107     <i><font color='green'>//pFile = *OVR_NEW DelegatedFile(pFile); // MA Testing</font></i>
<a name='L108'> 108     <b>if</b> (<a href='../Y/3225.html' title='Multiple used in 25 places.'>flags</a> &amp; <a href='../Y/1544.html' title='Multiple used in 4 places.'>Open_Buffered</a>)
<a name='L109'> 109         <a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a> = *<b>new</b> <a href='../D/81.html' title='Multiple defined in 3 places.'>BufferedFile</a>(<a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a>);
<a name='L110'> 110     <b>return</b> 1;
<a name='L111'> 111 <font color='red'>}</font>
<a name='L112'> 112 
<a name='L113'> 113 
<a name='L114'> 114 <i><font color='green'>// ** Overrides</font></i>
<a name='L115'> 115 
<a name='L116'> 116 <b>int</b> <a href='../D/1142.html' title='Multiple defined in 2 places.'>SysFile</a>::<a href='../R/317.html' title='Multiple refered from 6 places.'>GetErrorCode</a>()
<a name='L117'> 117 <font color='red'>{</font>
<a name='L118'> 118     <b>return</b> <a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a> ? <a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a>-&gt;<a href='../D/334.html' title='Multiple defined in 3 places.'>GetErrorCode</a>() : <a href='../Y/519.html' title='Multiple used in 4 places.'>Error_FileNotFound</a>;
<a name='L119'> 119 <font color='red'>}</font>
<a name='L120'> 120 
<a name='L121'> 121 
<a name='L122'> 122 <i><font color='green'>// Overrides to provide re-open support</font></i>
<a name='L123'> 123 <b>bool</b> <a href='../D/1142.html' title='Multiple defined in 2 places.'>SysFile</a>::<a href='../R/483.html' title='Multiple refered from 13 places.'>IsValid</a>()
<a name='L124'> 124 <font color='red'>{</font>
<a name='L125'> 125     <b>return</b> <a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a> &amp;&amp; <a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a>-&gt;<a href='../D/500.html' title='Multiple defined in 3 places.'>IsValid</a>();
<a name='L126'> 126 <font color='red'>}</font>
<a name='L127'> 127 <b>bool</b> <a href='../D/1142.html' title='Multiple defined in 2 places.'>SysFile</a>::<a href='../R/110.html' title='Multiple refered from 12 places.'>Close</a>()
<a name='L128'> 128 <font color='red'>{</font>
<a name='L129'> 129     <b>if</b> (<a href='../D/500.html' title='Multiple defined in 3 places.'>IsValid</a>())
<a name='L130'> 130     <font color='red'>{</font>
<a name='L131'> 131         <a href='../Y/364.html' title='Multiple used in 14 places.'>DelegatedFile</a>::<a href='../D/117.html' title='Multiple defined in 5 places.'>Close</a>();
<a name='L132'> 132         <a href='../Y/3931.html' title='Multiple used in 49 places.'>pFile</a> = *<b>new</b> <a href='../S/156.html#L40' title='Defined at 40 in ovr/sdk/src/Kernel/OVR_SysFile.cpp.'>UnopenedFile</a>;
<a name='L133'> 133         <b>return</b> 1;
<a name='L134'> 134     <font color='red'>}</font>
<a name='L135'> 135     <b>return</b> 0;
<a name='L136'> 136 <font color='red'>}</font>
<a name='L137'> 137 
<a name='L138'> 138 <font color='red'>}</font> <i><font color='green'>// OVR</font></i>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L46'>[^]</a><a href='#L127'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
